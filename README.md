局域网内的沟通软件

# 需求
---
总体需求：完成局域网内的实时群聊通信
- 需求一：展示当前在线人数
- 需求二：实时更新接收群聊内容
- 需求三：可以发送群聊消息

# 技术选型
---
- TCP通信
- 多线程
- Swing
- 面向对象
- 客户端服务端
# 思路分析
---

## 1、获取客户端登录的UI界面
创建一个客户端的Module，创建一个com.zyz.ui的包用于放置UI界面的代码。
创建一个APP class用于启动客户端程序。

需求：用户只需要输入登录名即可登录，一个输入框，两个按键：登录、取消。
待处理事件：
- 完善登录按键：与服务端建立Socket链接，告诉服务端自己上线了。
- 跳转到客户端聊天UI界面
## 2、获取客户端聊天UI界面
需求：将界面分为三的大部分，左上最大显示群聊信息，右侧一个竖着的栏展示谁在群聊中，底部是信息输入和发送按键。
待处理：
- 标签栏需要显示 XXX的群聊界面
- 需要一个独立的线程，不断接收来自客户端的群聊更新信息，包括在线用户以及群聊信息，并展示
- 给发送按键绑定事件监听器，将内容发送给服务端
## 3、服务端开发
**创建一个服务端的Module**

需求：服务端用于监听客户端的Socket链接，维护一组Socket，转发用户上下线消息以及群聊消息。

怎么做？
主线程用于接受Socket线程，子线程用于处理每一个Socket的功能。

**第一步：创建服务端主线程**，叫ChatServer

**第二步：开发主线程代码**
- 使用Socket接受连接，这里需要创建一个Constant类用于存端口号
- 在while循环中创建子线程，处理每个Socket任务
- 我们用Map来维护这一组Socket，键是Socket，值是nickname
**第三步：开发子线程代码**
- 子线程需要做什么事呢？当前已经有一个客户端连接到了服务器，那么这个链接就不能轻易断开。负责通信的就是这个Socket管道。所以子线程的Socket连接不能轻易断开。并且要不断接收。接收的信息有两种类型，第一种是用户上线信息，第二种是用户发送的信息。将主线程中的map传给子线程，那么每个子线程共同来维护这一个map，实现了Socket的管理。
- 规定第一种情况，客户端先发一个1，那么执行接受登录信息，将登录信息加入Map中，然后将最新的在线用户信息转发给每一个Socket。
- 写了一个updateUserList方法用于将最新的用户信息发给每个Socket
- 用户下线了用catch处理，先将map中的信息删除，再广播
- 规定第二种情况。客户端先发一个2，代表发送了群聊消息，服务端先接受2，再接受信息，然后将消息打包，广播给每一个Socket。
## 4、完善客户端的登录界面
- 点击登录时，需要和客户端进行Socket通信，告诉客户端我TM来了。
- 将这个socket管道传给聊天界面，并打开聊天界面
## 5、完善客户端聊天界面
- 需要在聊天界面创建一个子线程，用于实时接收服务端的消息。按照服务端的发送格式进行接收
- 在主线程中，给发送按钮配置点击事件，给服务端发送信息

# 新增私聊功能
---

## 1、修改客户端聊天UI界面
- 右键在线用户名，即可跳出二级菜单，有私聊和拍一拍，点击私聊即可跳到私聊界面
- 一个用户同一时间只能和一个人进行私聊，而且必须两个人同时打开私聊界面。








